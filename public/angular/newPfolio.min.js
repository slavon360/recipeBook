(function(){angular.module("myPortfolio",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,i){e.when("/",{templateUrl:"views/home/home.html",controller:"homeCtrl"}).when("/works",{templateUrl:"/views/works/works.html",controller:"worksCtrl"}).when("/tech",{templateUrl:"/views/tech/tech.html",controller:"techCtrl"}).when("/works/recipeBook",{templateUrl:"/views/works/recipeBook/mainPage.html",controller:"recipesCtrl"}).when("/works/recipes",{templateUrl:"/views/works/recipeBook/recipesList/recipesList.html",controller:"recipesCtrl"}).when("/works/recipes/:recipeid",{templateUrl:"/views/works/recipeBook/recipe/recipe.html",controller:"recipeCtrl"}).when("/works/recipes/:recipeid/edit",{templateUrl:"/views/works/recipeBook/edit/editRecipe.html",controller:"recipeCtrl"}).when("/works/recipes/:recipeid/history",{templateUrl:"/views/works/recipeBook/history/recipeHistory.html",controller:"recipeCtrl"}).when("/works/weatherApp",{templateUrl:"/views/works/weatherApp/weatherApp.html",controller:"weatherAppCtrl"}).otherwise({redirectTo:"/"});i.html5Mode({enabled:true,requireBase:false})}angular.module("myPortfolio").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("myPortfolio").controller("mainCtrl",e);e.$inject=["$scope","earthService","$location","apiHandlerService","$rootScope","$timeout","linkRenderer"];function e(e,i,n,t,o,r,c){e.pageState={newRecipe:false,imgGrid:false};e.newRecipe={};a();function a(){t.getHomePage().then(function(i){e.portfolio=i.data},function(e){console.log(e)})}l();function l(){t.getRecipesList().then(function(i){e.recipesList=i.data},function(e){console.log(e)})}e.$on("updatedRecipe",function(i,n){console.log("updated recipe:");console.log(n);var t=e.recipesList.map(function(e){if(e._id===n._id){return n}return e});e.recipesList=t;console.log(e.recipesList)});e.addRecipe=function(){if(!e.newRecipe||!e.newRecipe.name||!e.newRecipe.description){console.log("$scope.newRecipe not defined or form not filled");return false}t.newRecipe(e.newRecipe).then(function(i){e.recipesList.push(i.data);e.pageState.newRecipe=!e.pageState.newRecipe;e.newRecipe={};console.log(i);n.path("/works/recipes")},function(i){console.log(i);e.formError="Sorry, something went wrong. Please, repeat your action, or refresh the page"})};e.rotationValue=function(){return i.rotationValue};e.locationPathCollection=c.locationPathCollection(n.path());console.log("mainCtrl");e.$on("dropNewRecipe",function(i,n){e.newRecipe=n});e.$on("updateRecipesList",function(i,n){var t=e.recipesList.reduce(function(e,i){i._id!==n?e.push(i):"";return e},[]);e.recipesList=t});e.$on("currentHistoryList",function(i,n){e.recipeHistoryList=n});e.$on("getTotalNumberOfImgsFromApi",function(i,n){e.totalNumberOfImagesFromRespondedApi=n});e.$on("progressImgBar",function(i,n){var t={total:e.totalNumberOfImagesFromRespondedApi,counter:n};e.$broadcast("progressBarEvent",t)})}})();(function(){angular.module("myPortfolio").controller("homeCtrl",e);e.$inject=["$scope","earthService","$location","apiHandlerService","$rootScope","$timeout"];function e(e,i,n,t,o,r){}})();(function(){angular.module("myPortfolio").controller("worksCtrl",e);e.$inject=["$scope","apiHandlerService","worksNavigation"];function e(e,i,n){t();function t(){i.getWorksList().then(function(i){console.log(e.portfolio);e.portfolio.works=i.data},function(e){console.log(e)})}e.myList=[{name:"Recipe Book",description:"some info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info",background:'url("/images/recipeBook1.png")'},{name:"App 2",description:"some info-info-info-info-info-info-info-info"},{name:"App 3",description:"some info-info-info-info-info-info-info-info"},{name:"App 4",description:"some info-info-info-info-info-info-info-info"}];e.renderPosition=function(e){return n.renderWidth()*(e+n.currentPosition)+"%"};e.workItemWidth=function(){return n.renderWidth()+"%"};e.nextWork=function(){n.next(e.portfolio.works)};e.previousWork=function(){n.previous(e.portfolio.works)}}})();(function(){angular.module("myPortfolio").controller("techCtrl",e);e.$inject=["$scope","apiHandlerService"];function e(e,i){}})();(function(){angular.module("myPortfolio").controller("recipesCtrl",e);e.$inject=["$scope","apiHandlerService","$rootScope","$location","linkRenderer","$timeout"];function e(e,i,n,t,o,r){console.log("recipesCtrl");e.$on("transferLinks",function(i,n){e.recipeImages=n});e.addImgLink=function(i){if(e.recipeImages&&e.recipeImages.length>0){e.$parent.newRecipe.imgSrc=e.recipeImages[i]}else{console.log("imagesLinks is empty or undefined")}};e.locationPathCollection=o.locationPathCollection(t.path())}})();(function(){angular.module("myPortfolio").controller("recipeCtrl",e);e.$inject=["$scope","$location","linkRenderer","$routeParams","apiHandlerService","historyRecipeService","$timeout"];function e(e,i,n,t,o,r,c){console.log("recipeCtrl");e.dropNewRecipe=function(){if(e.$parent.newRecipe.hasOwnProperty("name")){e.$parent.newRecipe={}}};e.displayOldRecipe=function(n){o.getRecipeForEditing(n).then(function(t){i.path("/works/recipes/"+n+"/edit");e.$parent.newRecipe=t.data},function(e){console.log(e)})};function a(){if(e.$parent.newRecipe.hasOwnProperty("name")){return e.$parent.newRecipe}return e.$parent.recipesList.reduce(function(e,i){if(i._id==t.recipeid){e=i}return e},{})}e.currentRecipe=a();e.editRecipe=function(n){o.updateRecipe(n,e.$parent.newRecipe).then(function(t){e.$emit("updatedRecipe",t.data);e.$parent.newRecipe={};i.path("/works/recipes/"+n)},function(e){console.log(e)})};e.deleteRecipe=function(n){o.deleteRecipe(n).then(function(t){e.currentRecipe.clicked=true;c(function(){e.$emit("updateRecipesList",n);i.path("/works/recipes")},1e3)},function(e){console.log(e)})};e.locationPathCollection=n.locationPathCollection(i.path(),e.currentRecipe);e.$on("transferLinks",function(i,n){e.recipeImages=n});e.addImgLink=function(i){if(e.recipeImages&&e.recipeImages.length>0){e.$parent.newRecipe.imgSrc=e.recipeImages[i]}else{console.log("imagesLinks is empty or undefined")}};e.displayHistoryList=function(n){o.getRecipeHistory(n).then(function(t){e.$emit("currentHistoryList",t.data.history);i.path("/works/recipes/"+n+"/history")},function(e){console.log(e)})};e.deleteHistoryItem=function(i,n){n.clicked=true;o.deleteHistoryItem(t.recipeid,i).then(function(n){c(function(){e.$parent.recipeHistoryList=r.updateHistoryList(e.recipeHistoryList,i)},1e3)},function(e){console.log(e)})}}})();(function(){angular.module("myPortfolio").controller("weatherAppCtrl",e);e.$inject=["$scope","$http","factoryCities","apiHandlerService"];function e(e,i,n,t){e.cities=[];e.clearList=function(){e.cities=n.removeList(e.cities)};e.submitForm=function(){t.getWeatherInfo(e.weather.city).then(function(i){console.log(i);e.cities.push(i.data)},function(e){console.log(e)})}}})();(function(){angular.module("myPortfolio").service("apiHandlerService",e);e.$inject=["$http","historyRecipeService"];function e(e,i){var n="011077741888233176997:of7fjkpolfw",t="AIzaSyDLD44qvwYnkayTY-8iuwDV9M1J5r4NF0M",o="4633909-917c4f4afbf27eecf77953c87",r="https://cors-anywhere.herokuapp.com/";var c=function(){return e.get("/api")};var a=function(){return e.get("/api/works")};var l=function(){return e.get("/api/works/recipes")};var s=function(i){return e.post("/api/works/newRecipe",i)};var u=function(i){return e.get("https://www.googleapis.com/customsearch/v1?key="+t+"&cx="+n+"&q="+i+"&num=10&start=2&searchType=image&alt=json")};var p=function(i){return e.get("https://pixabay.com/api/?key="+o+"&q="+i+"&per_page=40")};var f=function(i){return e.get("/api/links/"+i)};var m=function(i){return e.get("/api/works/recipes/"+i+"/edit")};var d=function(i,n){return e.post("/api/works/recipes/"+i+"/edit",n)};var g=function(i){return e.delete("/api/works/recipes/"+i+"/delete")};var h=function(i){return e.get("/api/works/recipes/"+i+"/history")};var w=function(i,n){return e.delete("/api/works/recipes/"+i+"/history/"+n)};var v=function(i){return e.get(r+"http://api.openweathermap.org/data/2.5/weather?q="+i+"&units=metric&APPID=8d9223b647133c51d397626dcaa319ce")};return{getWorksList:a,getHomePage:c,getRecipesList:l,newRecipe:s,getImages:u,getImagesFromPixabay:p,linksFromComp:f,getRecipeForEditing:m,updateRecipe:d,deleteRecipe:g,getRecipeHistory:h,deleteHistoryItem:w,getWeatherInfo:v}}})();(function(){angular.module("myPortfolio").service("earthService",e);function e(){return{rotationValue:0,changeRotation:function(){if(this.rotationValue<180){return this.rotationValue+=180}else{return this.rotationValue=0}}}}})();(function(){angular.module("myPortfolio").service("worksNavigation",e);function e(){return{currentPosition:0,next:function(e){if(this.currentPosition>-(e.length-1)){this.currentPosition-=1}},previous:function(e){if(this.currentPosition!==0){this.currentPosition+=1}},renderWidth:function(){var e;if(window.outerWidth<=768){e=100}else{e=33.33}return e}}}})();(function(){angular.module("myPortfolio").service("linkRenderer",e);function e(){function e(e,i){var n=e.reduce(function(e,n){if(n.name===i._id){e.push({name:i.name,url:n.url})}else{e.push(n)}return e},[]);return n}var i=function(i,n){var t=i.split("/"),o=2;while(o){o--;t.shift()}var r=t.reduce(function(e,n){var t=i.indexOf(n)+n.length;e.push({name:n,url:i.slice(0,t)});return e},[]);if(n!==undefined){var c=e(r,n);return c}if(n===undefined){return r}};return{locationPathCollection:i}}})();(function(){angular.module("myPortfolio").service("imgHandler",e);e.$inject=["$timeout"];function e(e){var i=[],n=0;var t=function(e,i){var n=new Image;n.src=e;n.onerror=function(){var n="This url is not valide: "+e;i(new Error(n))};n.onload=function(){i(null,n.src)}};var o=function(e,o,r){e.$emit("getTotalNumberOfImgsFromApi",o.length);e.totalImgs=o.length;var c=o.map(function(o,c,a){t(o.webformatURL,function(t,o){if(t){n++;throw t}n++;e.$emit("progressImgBar",n);i.push(o);if(n===a.length){r(i);e.$emit("transferLinks",i);i=[];n=0}})})};return{imgValidate:o}}})();(function(){angular.module("myPortfolio").service("historyRecipeService",e);function e(){var e=function(e,i){var n=e.reduce(function(e,n){n._id!==i?e.push(n):"";return e},[]);return n};return{updateHistoryList:e}}})();(function(){angular.module("myPortfolio").factory("factoryCities",e);function e(){return{removeList:function(e){return e=[]}}}})();(function(){angular.module("myPortfolio").service("pageHandlerService",e);function e(){var e=[];return{pageWasVisited:function(i){var n;console.log(e);e.forEach(function(e){if(e===i){n=true}});return n},includePage:function(i){if(i){e.push(i)}}}}})();(function(){angular.module("myPortfolio").directive("footerEarth",e);e.$inject=["earthService"];function e(e){return{restrict:"EA",templateUrl:"/common/directives/footer-earth/footer-earth.template.html"}}})();(function(){angular.module("myPortfolio").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("myPortfolio").directive("earthProcess",e);e.$inject=["earthService","$location","$timeout","$rootScope"];function e(e,i,n,t){return{restrict:"EA",link:function(n,t,o){n.$on("$routeChangeSuccess",function(e,n,r){if(i.path()===o.href){t.css("color","white")}else{t.css("color","")}});t.bind("click",function(){n.$apply(function(){e.changeRotation()})});t.bind("mouseover",function(){t.css("cursor","pointer")})}}}})();(function(){angular.module("myPortfolio").directive("carousel",e);e.$inject=["$timeout"];function e(e){return{restrict:"E",scope:{works:"="},templateUrl:"/common/directives/carousel/carousel.template.html",link:function(i,n){e(function(){$(".carousel-inner .item",n).first().addClass("active")})}}}})();(function(){angular.module("myPortfolio").directive("newRecipe",e);e.$inject=["$compile"];function e(e){var i="<ng-include src=\"'/common/directives/new-recipe/newRecipe.html'\"></ng-include>";var n=function(e){if(e.pageState.newRecipe){e.$emit("dropNewRecipe",{});return'<ng-include page-display msec="1000" src="\'/views/works/recipeBook/mainPage.html\'"></ng-include>'}return'<div page-display msec="2000" ><ng-include src="\'/common/directives/new-recipe/newRecipe.html\'"></ng-include></div>'};return{link:function(i,t,o){t.on("click",function(){i.$apply(function(){var o=e(n(i))(i,function(e,n){t.parent().parent().replaceWith(e);i.pageState.newRecipe=!i.pageState.newRecipe})})})},restrict:"EA"}}})();(function(){angular.module("myPortfolio").directive("chooseImages",e);e.$inject=["apiHandlerService","$compile","imgHandler","$timeout"];function e(e,i,n,t){var o='<div class="parent-images-grid-wrapper" ng-include="\'/common/directives/new-recipe/searchEngine.template.html\'"></div>',r;return{restrict:"EA",link:function(t,c,a){c.on("click",function(){if(t.recipeImages===undefined||t.newRecipe.name!==r){t.$apply(function(){t.recipeImages=[]});t.totalImgs=true;e.getImagesFromPixabay(t.newRecipe.name).then(function(e){console.log(e);n.imgValidate(t,e.data.hits,function(e){t.$apply(function(){t.recipeImages=e})});r=t.newRecipe.name},function(e){console.log(e)})}t.$apply(function(){var e=i(o)(t,function(e,i){if(!t.pageState.imgGrid){c.append(e);t.pageState.imgGrid=!t.pageState.imgGrid}else{c[0].querySelector(".images-grid-wrapper1").remove();t.pageState.imgGrid=!t.pageState.imgGrid}})})})}}}})();(function(){angular.module("myPortfolio").directive("progressBar",e);function e(){var e=function(e){var i=100/e.total*e.counter;return i+"%"};return{restrict:"EA",link:function(i,n,t){n.append('<div class="progress-img-bar-child"></div>');i.$on("progressBarEvent",function(i,t){n.children().css("width",e(t))})}}}})();(function(){angular.module("myPortfolio").directive("techRenderer",e);e.$inject=["$interval"];function e(e){function i(i,n,t){var o=i/n,r=0,c=parseInt(n);var a=e(function(){r+=1;t(r);if(r===c){e.cancel(a)}},o)}return{restrict:"EA",link:function(e,n,t){var o=t.nameTech,r=t.points,c=t.msec,a;function l(e){if(e<20){return"rgba(194, 17, 17, .8)"}if(e<60){return"rgba(247, 228, 15, .9);"}else{return"rgba(3, 163, 33, .8);"}}i(c,r,function(e){a=e;n.html("<span>"+" "+o+' <span class="tab-bar">'+a+'%</span></span><div style="width:'+a+"%;background:"+l(a)+'" class="tech-bar"></div>')})}}}})();(function(){angular.module("myPortfolio").directive("myContacts",e);function e(){return{restrict:"EA",link:function(e,i,n){i.html('<a class="facebook" href="https://www.facebook.com/viacheslav360" target="_blank"></a><a class="linkedin" href="https://www.linkedin.com/in/viacheslav-liakh-656171131" target="_blank"></a><a class="twitter" href="https://twitter.com/slavon360" target="_blank"></a>')}}}})();(function(){angular.module("myPortfolio").directive("pageDisplay",e);e.$inject=["$timeout","pageHandlerService"];function e(e,i){return{restrict:"EA",link:function(n,t,o){var r=o.msec,c=o.pageName;if(i.pageWasVisited(c)){return}i.includePage(c);t.append('<loading class="loading-thing"><div class="loading-circle"></div><img class="loading-image" src="/images/profile.png"></loading>');e(function(){t.find("loading").remove()},r)}}}})();