(function(){angular.module("myPortfolio",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,t){e.when("/",{templateUrl:"views/home/home.html",controller:"homeCtrl"}).when("/works",{templateUrl:"/views/works/works.html",controller:"worksCtrl"}).when("/tech",{templateUrl:"/views/tech/tech.html",controller:"techCtrl"}).when("/works/recipeBook",{templateUrl:"/views/works/recipeBook/mainPage.html",controller:"recipesCtrl"}).when("/works/recipes",{templateUrl:"/views/works/recipeBook/recipesList/recipesList.html",controller:"recipesCtrl"}).when("/works/recipes/:recipeid",{templateUrl:"/views/works/recipeBook/recipe/recipe.html",controller:"recipeCtrl"}).when("/works/recipes/:recipeid/edit",{templateUrl:"/views/works/recipeBook/edit/editRecipe.html",controller:"recipeCtrl"}).when("/works/recipes/:recipeid/history",{templateUrl:"/views/works/recipeBook/history/recipeHistory.html",controller:"recipeCtrl"}).when("/works/weatherApp",{templateUrl:"/views/works/weatherApp/weatherApp.html",controller:"weatherAppCtrl"}).otherwise({redirectTo:"/"});t.html5Mode({enabled:true,requireBase:false})}angular.module("myPortfolio").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("myPortfolio").controller("mainCtrl",e);e.$inject=["$scope","earthService","$location","apiHandlerService","$rootScope","$timeout","linkRenderer"];function e(e,t,i,n,o,r,c){e.pageState={newRecipe:false,imgGrid:false};e.newRecipe={};a();function a(){n.getHomePage().then(function(t){e.portfolio=t.data},function(e){console.log(e)})}l();function l(){n.getRecipesList().then(function(t){e.recipesList=t.data},function(e){console.log(e)})}e.$on("updatedRecipe",function(t,i){console.log("updated recipe:");console.log(i);var n=e.recipesList.map(function(e){if(e._id===i._id){return i}return e});e.recipesList=n;console.log(e.recipesList)});e.addRecipe=function(){if(!e.newRecipe||!e.newRecipe.name||!e.newRecipe.description){console.log("$scope.newRecipe not defined or form not filled");return false}n.newRecipe(e.newRecipe).then(function(t){e.recipesList.push(t.data);e.pageState.newRecipe=!e.pageState.newRecipe;e.newRecipe={};console.log(t);i.path("/works/recipes")},function(t){console.log(t);e.formError="Sorry, something went wrong. Please, repeat your action, or refresh the page"})};e.rotationValue=function(){return t.rotationValue};e.locationPathCollection=c.locationPathCollection(i.path());console.log("mainCtrl");e.$on("dropNewRecipe",function(t,i){e.newRecipe=i});e.$on("updateRecipesList",function(t,i){var n=e.recipesList.reduce(function(e,t){t._id!==i?e.push(t):"";return e},[]);e.recipesList=n});e.$on("currentHistoryList",function(t,i){e.recipeHistoryList=i});e.$on("getTotalNumberOfImgsFromApi",function(t,i){e.totalNumberOfImagesFromRespondedApi=i});e.$on("progressImgBar",function(t,i){var n={total:e.totalNumberOfImagesFromRespondedApi,counter:i};e.$broadcast("progressBarEvent",n)})}})();(function(){angular.module("myPortfolio").controller("homeCtrl",e);e.$inject=["$scope","earthService","$location","apiHandlerService","$rootScope","$timeout"];function e(e,t,i,n,o,r){}})();(function(){angular.module("myPortfolio").controller("worksCtrl",e);e.$inject=["$scope","apiHandlerService","worksNavigation"];function e(e,t,i){n();function n(){t.getWorksList().then(function(t){console.log(e.portfolio);e.portfolio.works=t.data},function(e){console.log(e)})}e.myList=[{name:"Recipe Book",description:"some info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info-info",background:'url("/images/recipeBook1.png")'},{name:"App 2",description:"some info-info-info-info-info-info-info-info"},{name:"App 3",description:"some info-info-info-info-info-info-info-info"},{name:"App 4",description:"some info-info-info-info-info-info-info-info"}];e.renderPosition=function(e){return i.renderWidth()*(e+i.currentPosition)+"%"};e.workItemWidth=function(){return i.renderWidth()+"%"};e.nextWork=function(){i.next(e.portfolio.works)};e.previousWork=function(){i.previous(e.portfolio.works)}}})();(function(){angular.module("myPortfolio").controller("techCtrl",e);e.$inject=["$scope","apiHandlerService"];function e(e,t){}})();(function(){angular.module("myPortfolio").controller("recipesCtrl",e);e.$inject=["$scope","apiHandlerService","$rootScope","$location","linkRenderer","$timeout"];function e(e,t,i,n,o,r){console.log("recipesCtrl");e.$on("transferLinks",function(t,i){e.recipeImages=i});e.addImgLink=function(t){if(e.recipeImages&&e.recipeImages.length>0){e.$parent.newRecipe.imgSrc=e.recipeImages[t]}else{console.log("imagesLinks is empty or undefined")}};e.locationPathCollection=o.locationPathCollection(n.path())}})();(function(){angular.module("myPortfolio").controller("recipeCtrl",e);e.$inject=["$scope","$location","linkRenderer","$routeParams","apiHandlerService","historyRecipeService","$timeout"];function e(e,t,i,n,o,r,c){console.log("recipeCtrl");e.dropNewRecipe=function(){if(e.$parent.newRecipe.hasOwnProperty("name")){e.$parent.newRecipe={}}};e.displayOldRecipe=function(i){o.getRecipeForEditing(i).then(function(n){t.path("/works/recipes/"+i+"/edit");e.$parent.newRecipe=n.data},function(e){console.log(e)})};function a(){if(e.$parent.newRecipe.hasOwnProperty("name")){return e.$parent.newRecipe}return e.$parent.recipesList.reduce(function(e,t){if(t._id==n.recipeid){e=t}return e},{})}e.currentRecipe=a();e.editRecipe=function(i){o.updateRecipe(i,e.$parent.newRecipe).then(function(n){e.$emit("updatedRecipe",n.data);e.$parent.newRecipe={};t.path("/works/recipes/"+i)},function(e){console.log(e)})};e.deleteRecipe=function(i){o.deleteRecipe(i).then(function(n){e.currentRecipe.clicked=true;c(function(){e.$emit("updateRecipesList",i);t.path("/works/recipes")},1e3)},function(e){console.log(e)})};e.locationPathCollection=i.locationPathCollection(t.path(),e.currentRecipe);e.$on("transferLinks",function(t,i){e.recipeImages=i});e.addImgLink=function(t){if(e.recipeImages&&e.recipeImages.length>0){e.$parent.newRecipe.imgSrc=e.recipeImages[t]}else{console.log("imagesLinks is empty or undefined")}};e.displayHistoryList=function(i){o.getRecipeHistory(i).then(function(n){e.$emit("currentHistoryList",n.data.history);t.path("/works/recipes/"+i+"/history")},function(e){console.log(e)})};e.deleteHistoryItem=function(t,i){i.clicked=true;o.deleteHistoryItem(n.recipeid,t).then(function(i){c(function(){e.$parent.recipeHistoryList=r.updateHistoryList(e.recipeHistoryList,t)},1e3)},function(e){console.log(e)})}}})();(function(){angular.module("myPortfolio").controller("weatherAppCtrl",e);e.$inject=["$scope","$http","factoryCities"];function e(e,t,i){e.cities=[];e.clearList=function(){e.cities=i.removeList(e.cities)};e.submitForm=function(){t.get("http://api.openweathermap.org/data/2.5/weather?q="+e.weather.city+"&units=metric&APPID=8d9223b647133c51d397626dcaa319ce").then(function(t){e.cities.push(t.data)})}}})();(function(){angular.module("myPortfolio").service("apiHandlerService",e);e.$inject=["$http","historyRecipeService"];function e(e,t){var i="011077741888233176997:of7fjkpolfw",n="AIzaSyDLD44qvwYnkayTY-8iuwDV9M1J5r4NF0M",o="4633909-917c4f4afbf27eecf77953c87";var r=function(){return e.get("/api")};var c=function(){return e.get("/api/works")};var a=function(){return e.get("/api/works/recipes")};var l=function(t){return e.post("/api/works/newRecipe",t)};var s=function(t){return e.get("https://www.googleapis.com/customsearch/v1?key="+n+"&cx="+i+"&q="+t+"&num=10&start=2&searchType=image&alt=json")};var u=function(t){return e.get("https://pixabay.com/api/?key="+o+"&q="+t+"&per_page=40")};var p=function(t){return e.get("/api/links/"+t)};var f=function(t){return e.get("/api/works/recipes/"+t+"/edit")};var m=function(t,i){return e.post("/api/works/recipes/"+t+"/edit",i)};var d=function(t){return e.delete("/api/works/recipes/"+t+"/delete")};var g=function(t){return e.get("/api/works/recipes/"+t+"/history")};var h=function(t,i){return e.delete("/api/works/recipes/"+t+"/history/"+i)};return{getWorksList:c,getHomePage:r,getRecipesList:a,newRecipe:l,getImages:s,getImagesFromPixabay:u,linksFromComp:p,getRecipeForEditing:f,updateRecipe:m,deleteRecipe:d,getRecipeHistory:g,deleteHistoryItem:h}}})();(function(){angular.module("myPortfolio").service("earthService",e);function e(){return{rotationValue:0,changeRotation:function(){if(this.rotationValue<180){return this.rotationValue+=180}else{return this.rotationValue=0}}}}})();(function(){angular.module("myPortfolio").service("worksNavigation",e);function e(){return{currentPosition:0,next:function(e){if(this.currentPosition>-(e.length-1)){this.currentPosition-=1}},previous:function(e){if(this.currentPosition!==0){this.currentPosition+=1}},renderWidth:function(){var e;if(window.outerWidth<=768){e=100}else{e=33.33}return e}}}})();(function(){angular.module("myPortfolio").service("linkRenderer",e);function e(){function e(e,t){var i=e.reduce(function(e,i){if(i.name===t._id){e.push({name:t.name,url:i.url})}else{e.push(i)}return e},[]);return i}var t=function(t,i){var n=t.split("/"),o=2;while(o){o--;n.shift()}var r=n.reduce(function(e,i){var n=t.indexOf(i)+i.length;e.push({name:i,url:t.slice(0,n)});return e},[]);if(i!==undefined){var c=e(r,i);return c}if(i===undefined){return r}};return{locationPathCollection:t}}})();(function(){angular.module("myPortfolio").service("imgHandler",e);e.$inject=["$timeout"];function e(e){var t=[],i=0;var n=function(e,t){var i=new Image;i.src=e;i.onerror=function(){var i="This url is not valide: "+e;t(new Error(i))};i.onload=function(){t(null,i.src)}};var o=function(e,o,r){e.$emit("getTotalNumberOfImgsFromApi",o.length);e.totalImgs=o.length;var c=o.map(function(o,c,a){n(o.webformatURL,function(n,o){if(n){i++;throw n}i++;e.$emit("progressImgBar",i);t.push(o);if(i===a.length){r(t);e.$emit("transferLinks",t);t=[];i=0}})})};return{imgValidate:o}}})();(function(){angular.module("myPortfolio").service("historyRecipeService",e);function e(){var e=function(e,t){var i=e.reduce(function(e,i){i._id!==t?e.push(i):"";return e},[]);return i};return{updateHistoryList:e}}})();(function(){angular.module("myPortfolio").factory("factoryCities",e);function e(){return{removeList:function(e){return e=[]}}}})();(function(){angular.module("myPortfolio").directive("footerEarth",e);e.$inject=["earthService"];function e(e){return{restrict:"EA",templateUrl:"/common/directives/footer-earth/footer-earth.template.html"}}})();(function(){angular.module("myPortfolio").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("myPortfolio").directive("earthProcess",e);e.$inject=["earthService","$location","$timeout","$rootScope"];function e(e,t,i,n){return{restrict:"EA",link:function(i,n,o){i.$on("$routeChangeSuccess",function(e,i,r){if(t.path()===o.href){n.css("color","white")}else{n.css("color","")}});n.bind("click",function(){i.$apply(function(){e.changeRotation()})});n.bind("mouseover",function(){n.css("cursor","pointer")})}}}})();(function(){angular.module("myPortfolio").directive("carousel",e);e.$inject=["$timeout"];function e(e){return{restrict:"E",scope:{works:"="},templateUrl:"/common/directives/carousel/carousel.template.html",link:function(t,i){e(function(){$(".carousel-inner .item",i).first().addClass("active")})}}}})();(function(){angular.module("myPortfolio").directive("newRecipe",e);e.$inject=["$compile"];function e(e){var t="<ng-include src=\"'/common/directives/new-recipe/newRecipe.html'\"></ng-include>";var i=function(e){if(e.pageState.newRecipe){e.$emit("dropNewRecipe",{});return"<ng-include src=\"'/views/works/recipeBook/mainPage.html'\"></ng-include>"}return"<ng-include src=\"'/common/directives/new-recipe/newRecipe.html'\"></ng-include>"};return{link:function(t,n,o){n.on("click",function(){t.$apply(function(){var o=e(i(t))(t,function(e,i){n.parent().parent().replaceWith(e);t.pageState.newRecipe=!t.pageState.newRecipe})})})},restrict:"EA"}}})();(function(){angular.module("myPortfolio").directive("chooseImages",e);e.$inject=["apiHandlerService","$compile","imgHandler","$timeout"];function e(e,t,i,n){var o="<ng-include src=\"'/common/directives/new-recipe/searchEngine.template.html'\"></ng-include>",r;return{restrict:"EA",link:function(n,c,a){c.on("click",function(){if(n.recipeImages===undefined||n.newRecipe.name!==r){n.$apply(function(){n.recipeImages=[]});n.totalImgs=true;e.getImagesFromPixabay(n.newRecipe.name).then(function(e){console.log(e);i.imgValidate(n,e.data.hits,function(e){n.$apply(function(){n.recipeImages=e})});r=n.newRecipe.name},function(e){console.log(e)})}n.$apply(function(){var e=t(o)(n,function(e,t){if(!n.pageState.imgGrid){c.append(e);n.pageState.imgGrid=!n.pageState.imgGrid}else{c[0].querySelector(".images-grid-wrapper1").remove();n.pageState.imgGrid=!n.pageState.imgGrid}})})})}}}})();(function(){angular.module("myPortfolio").directive("progressBar",e);function e(){var e=function(e){var t=100/e.total*e.counter;return t+"%"};return{restrict:"EA",link:function(t,i,n){i.append('<div class="progress-img-bar-child"></div>');t.$on("progressBarEvent",function(t,n){i.children().css("width",e(n))})}}}})();(function(){angular.module("myPortfolio").directive("techRenderer",e);e.$inject=["$interval"];function e(e){function t(t,i,n){var o=t/i,r=0,c=parseInt(i);var a=e(function(){r+=1;n(r);if(r===c){e.cancel(a)}},o)}return{restrict:"EA",link:function(e,i,n){var o=n.nameTech,r=n.points,c=n.msec,a;function l(e){if(e<20){return"rgba(194, 17, 17, .8)"}if(e<60){return"rgba(247, 228, 15, .9);"}else{return"rgba(3, 163, 33, .8);"}}t(c,r,function(e){a=e;i.html("<span>"+" "+o+' <span class="tab-bar">'+a+'%</span></span><div style="width:'+a+"%;background:"+l(a)+'" class="tech-bar"></div>')})}}}})();(function(){angular.module("myPortfolio").directive("myContacts",e);function e(){return{restrict:"EA",link:function(e,t,i){t.html('<a class="facebook" href="https://www.facebook.com/viacheslav360" target="_blank"></a><a class="linkedin" href="https://www.linkedin.com/in/viacheslav-liakh-656171131" target="_blank"></a><a class="twitter" href="https://twitter.com/slavon360" target="_blank"></a>')}}}})();